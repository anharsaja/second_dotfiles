var iframe=function(){"use strict";var se=Object.defineProperty;var B=c=>{throw TypeError(c)};var ie=(c,a,d)=>a in c?se(c,a,{enumerable:!0,configurable:!0,writable:!0,value:d}):c[a]=d;var $=(c,a,d)=>ie(c,typeof a!="symbol"?a+"":a,d),G=(c,a,d)=>a.has(c)||B("Cannot "+d);var R=(c,a,d)=>(G(c,a,"read from private field"),d?d.call(c):a.get(c)),x=(c,a,d)=>a.has(c)?B("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(c):a.set(c,d),H=(c,a,d,A)=>(G(c,a,"write to private field"),A?A.call(c,d):a.set(c,d),d),U=(c,a,d)=>(G(c,a,"access private method"),d);var j,W,M,T,D,y,J,q;function c(t){return t}const a=((W=(j=globalThis.browser)==null?void 0:j.runtime)==null?void 0:W.id)==null?globalThis.chrome:globalThis.browser;function d(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var A={exports:{}};(function(t){var n=Object.prototype.hasOwnProperty,e="~";function l(){}Object.create&&(l.prototype=Object.create(null),new l().__proto__||(e=!1));function _(u,s,i){this.fn=u,this.context=s,this.once=i||!1}function g(u,s,i,o,m){if(typeof i!="function")throw new TypeError("The listener must be a function");var p=new _(i,o||u,m),f=e?e+s:s;return u._events[f]?u._events[f].fn?u._events[f]=[u._events[f],p]:u._events[f].push(p):(u._events[f]=p,u._eventsCount++),u}function S(u,s){--u._eventsCount===0?u._events=new l:delete u._events[s]}function v(){this._events=new l,this._eventsCount=0}v.prototype.eventNames=function(){var s=[],i,o;if(this._eventsCount===0)return s;for(o in i=this._events)n.call(i,o)&&s.push(e?o.slice(1):o);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(i)):s},v.prototype.listeners=function(s){var i=e?e+s:s,o=this._events[i];if(!o)return[];if(o.fn)return[o.fn];for(var m=0,p=o.length,f=new Array(p);m<p;m++)f[m]=o[m].fn;return f},v.prototype.listenerCount=function(s){var i=e?e+s:s,o=this._events[i];return o?o.fn?1:o.length:0},v.prototype.emit=function(s,i,o,m,p,f){var E=e?e+s:s;if(!this._events[E])return!1;var r=this._events[E],w=arguments.length,I,h;if(r.fn){switch(r.once&&this.removeListener(s,r.fn,void 0,!0),w){case 1:return r.fn.call(r.context),!0;case 2:return r.fn.call(r.context,i),!0;case 3:return r.fn.call(r.context,i,o),!0;case 4:return r.fn.call(r.context,i,o,m),!0;case 5:return r.fn.call(r.context,i,o,m,p),!0;case 6:return r.fn.call(r.context,i,o,m,p,f),!0}for(h=1,I=new Array(w-1);h<w;h++)I[h-1]=arguments[h];r.fn.apply(r.context,I)}else{var re=r.length,O;for(h=0;h<re;h++)switch(r[h].once&&this.removeListener(s,r[h].fn,void 0,!0),w){case 1:r[h].fn.call(r[h].context);break;case 2:r[h].fn.call(r[h].context,i);break;case 3:r[h].fn.call(r[h].context,i,o);break;case 4:r[h].fn.call(r[h].context,i,o,m);break;default:if(!I)for(O=1,I=new Array(w-1);O<w;O++)I[O-1]=arguments[O];r[h].fn.apply(r[h].context,I)}}return!0},v.prototype.on=function(s,i,o){return g(this,s,i,o,!1)},v.prototype.once=function(s,i,o){return g(this,s,i,o,!0)},v.prototype.removeListener=function(s,i,o,m){var p=e?e+s:s;if(!this._events[p])return this;if(!i)return S(this,p),this;var f=this._events[p];if(f.fn)f.fn===i&&(!m||f.once)&&(!o||f.context===o)&&S(this,p);else{for(var E=0,r=[],w=f.length;E<w;E++)(f[E].fn!==i||m&&!f[E].once||o&&f[E].context!==o)&&r.push(f[E]);r.length?this._events[p]=r.length===1?r[0]:r:S(this,p)}return this},v.prototype.removeAllListeners=function(s){var i;return s?(i=e?e+s:s,this._events[i]&&S(this,i)):(this._events=new l,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prefixed=e,v.EventEmitter=v,t.exports=v})(A);var X=A.exports;const z=d(X);let b,L;class K extends z{constructor(){super(),L=this}send(n){b==null||b.postMessage(n)}getUrl(){return self.location.href}}self!==top&&(window.iFrame=K,b=a.runtime.connect({name:"iFrame"}),b.onMessage.addListener(t=>{switch(t.event){case"updateData":return L==null?void 0:L.emit("UpdateData")}}),b.onDisconnect.addListener(()=>{b=void 0}));const Q={allFrames:!0,main(){},matches:["<all_urls>"],runAt:"document_start"};function F(t,...n){}const Z={debug:(...t)=>F(console.debug,...t),log:(...t)=>F(console.log,...t),warn:(...t)=>F(console.warn,...t),error:(...t)=>F(console.error,...t)},ee={BASE_URL:"/",BROWSER:"chrome",CHROME:!0,COMMAND:"build",DEV:!1,EDGE:!1,ENTRYPOINT:"iframe",FIREFOX:!1,MANIFEST_VERSION:3,MODE:"production",OPERA:!1,PROD:!0,SAFARI:!1,SSR:!1,VITE_CJS_IGNORE_WARNING:"true"},P=class P extends Event{constructor(n,e){super(P.EVENT_NAME,{}),this.newUrl=n,this.oldUrl=e}};$(P,"EVENT_NAME",Y("wxt:locationchange"));let V=P;function Y(t){var e;const n=typeof ee>"u"?"build":"iframe";return`${(e=a==null?void 0:a.runtime)==null?void 0:e.id}:${n}:${t}`}function te(t){let n,e;return{run(){n==null&&(e=new URL(location.href),n=t.setInterval(()=>{let l=new URL(location.href);l.href!==e.href&&(window.dispatchEvent(new V(l,e)),e=l)},1e3))}}}const N=class N{constructor(n,e){x(this,y);x(this,M,window.self===window.top);x(this,T);x(this,D,te(this));this.contentScriptName=n,this.options=e,H(this,T,new AbortController),R(this,M)?(U(this,y,q).call(this,{ignoreFirstEvent:!0}),U(this,y,J).call(this)):U(this,y,q).call(this)}get signal(){return R(this,T).signal}abort(n){return R(this,T).abort(n)}get isInvalid(){return a.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(n){return this.signal.addEventListener("abort",n),()=>this.signal.removeEventListener("abort",n)}block(){return new Promise(()=>{})}setInterval(n,e){const l=setInterval(()=>{this.isValid&&n()},e);return this.onInvalidated(()=>clearInterval(l)),l}setTimeout(n,e){const l=setTimeout(()=>{this.isValid&&n()},e);return this.onInvalidated(()=>clearTimeout(l)),l}requestAnimationFrame(n){const e=requestAnimationFrame((...l)=>{this.isValid&&n(...l)});return this.onInvalidated(()=>cancelAnimationFrame(e)),e}requestIdleCallback(n,e){const l=requestIdleCallback((..._)=>{this.signal.aborted||n(..._)},e);return this.onInvalidated(()=>cancelIdleCallback(l)),l}addEventListener(n,e,l,_){var g;e==="wxt:locationchange"&&this.isValid&&R(this,D).run(),(g=n.addEventListener)==null||g.call(n,e.startsWith("wxt:")?Y(e):e,l,{..._,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),Z.debug(`Content script "${this.contentScriptName}" context invalidated`)}};M=new WeakMap,T=new WeakMap,D=new WeakMap,y=new WeakSet,J=function(){window.postMessage({type:N.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName},"*")},q=function(n){let e=!0;const l=_=>{var g,S;if(((g=_.data)==null?void 0:g.type)===N.SCRIPT_STARTED_MESSAGE_TYPE&&((S=_.data)==null?void 0:S.contentScriptName)===this.contentScriptName){const v=e;if(e=!1,v&&(n!=null&&n.ignoreFirstEvent))return;this.notifyInvalidated()}};addEventListener("message",l),this.onInvalidated(()=>removeEventListener("message",l))},$(N,"SCRIPT_STARTED_MESSAGE_TYPE","wxt:content-script-started");let k=N;function oe(){}function C(t,...n){}const ne={debug:(...t)=>C(console.debug,...t),log:(...t)=>C(console.log,...t),warn:(...t)=>C(console.warn,...t),error:(...t)=>C(console.error,...t)};return(async()=>{try{const{main:t,...n}=Q,e=new k("iframe",n);return await t(e)}catch(t){throw ne.error('The content script "iframe" crashed on startup!',t),t}})()}();
iframe;
//# sourceMappingURL=iframe.js.map
